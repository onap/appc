/*-
 * ============LICENSE_START=======================================================
 * ONAP : APP-C
 * ================================================================================
 * Copyright (C) 2017 AT&T Intellectual Property.  All rights reserved.
 * ================================================================================
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============LICENSE_END=========================================================
 */

[{"id":"cf792cb4.c5fc1","type":"not-found","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":508,"y":276,"z":"149c03da.6855dc","wires":[["bccec7e0.e85648"]]},{"id":"e3067cb4.9cbc5","type":"dgstart","name":"DGSTART","outputs":1,"x":158,"y":105,"z":"149c03da.6855dc","wires":[["c9b8010d.5b259"]]},{"id":"c9b8010d.5b259","type":"service-logic","name":"APPC 4.0.0","module":"APPC","version":"4.0.0","comments":"","xml":"<service-logic xmlns='http://www.openecomp.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.openecomp.org/sdnc/svclogic ./svclogic.xsd' module='APPC' version='4.0.0'>","outputs":1,"x":334,"y":102,"z":"149c03da.6855dc","wires":[["f3b373c9.7c789"]]},{"id":"f3b373c9.7c789","type":"method","name":"method CheckConfigStatus","xml":"<method rpc='CheckConfigStatus' mode='sync'>\n","comments":"","outputs":1,"x":562,"y":103,"z":"149c03da.6855dc","wires":[["a3a82482.ab3f28"]]},{"id":"4e43662a.ee91c8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":158,"y":233,"z":"149c03da.6855dc","wires":[["7005d829.ad8ca8","be1359f3.76fed8"]]},{"id":"a3963266.b475c","type":"failure","name":"Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":496,"y":458,"z":"149c03da.6855dc","wires":[["665ac5e1.5e6cfc"]]},{"id":"665ac5e1.5e6cfc","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":646,"y":460,"z":"149c03da.6855dc","wires":[["db84df7.6a6322"]]},{"id":"7005d829.ad8ca8","type":"configure","name":"configure: SftpAdaptor: GetConfig Success ","xml":"<configure adaptor=\"org.openecomp.appc.ccadaptor.ConfigComponentAdaptor\" key=\"get\">\n<parameter name=\"host\" value=\"`$vnf-host-ip-address`\"/>\n<parameter name=\"loginId\" value=\"`$device-authentication.USER-NAME`\"/>\n<parameter name=\"password\" value=\"`$device-authentication.PASSWORD`\"/>\n<parameter name=\"fullPathFileName\" value=\"`$configfilereference-success.TARGET-FILE-PATH`\"/>\t\n\n","comments":"","outputs":1,"x":257,"y":396,"z":"149c03da.6855dc","wires":[["cf792cb4.c5fc1","a3963266.b475c","608cebd8.10b624"]]},{"id":"db84df7.6a6322","type":"configure","name":"configure: SftpAdaptor: GetConfig Failure","xml":"<configure adaptor=\"org.openecomp.appc.ccadaptor.ConfigComponentAdaptor\" key=\"get\">\n<parameter name=\"host\" value=\"`$vnf-host-ip-address`\"/>\n<parameter name=\"loginId\" value=\"`$device-authentication.USER-NAME`\"/>\n<parameter name=\"password\" value=\"`$device-authentication.PASSWORD`\"/>\n<parameter name=\"fullPathFileName\" value=\"`$configfilereference-failure.TARGET-FILE-PATH`\"/>\n","comments":"","outputs":1,"x":901,"y":460,"z":"149c03da.6855dc","wires":[["f017767.f98fb88","6cde3091.955c1","49953086.03f73"]]},{"id":"f017767.f98fb88","type":"not-found","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":585,"y":573,"z":"149c03da.6855dc","wires":[["11221226.6595fe"]]},{"id":"11221226.6595fe","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":752,"y":576,"z":"149c03da.6855dc","wires":[["5e6a6545.c05b8c"]]},{"id":"5e6a6545.c05b8c","type":"configure","name":"configure: SftpAdaptor: GetConfig FailureLog","xml":"<configure adaptor=\"org.openecomp.appc.ccadaptor.ConfigComponentAdaptor\" key=\"get\">\n<parameter name=\"host\" value=\"`$vnf-host-ip-address`\"/>\n<parameter name=\"loginId\" value=\"`$device-authentication.USER-NAME`\"/>\n<parameter name=\"password\" value=\"`$device-authentication.PASSWORD`\"/>\n<parameter name=\"fullPathFileName\" value=\"`$configfilereference-log.TARGET-FILE-PATH`\"/>\n\n","comments":"","outputs":1,"x":1032,"y":580,"z":"149c03da.6855dc","wires":[["43dc78f.d70fe88","86972c32.24588"]]},{"id":"43dc78f.d70fe88","type":"not-found","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1333,"y":535,"z":"149c03da.6855dc","wires":[["7fb331c5.b68e"]]},{"id":"6cde3091.955c1","type":"failure","name":"Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":608,"y":912,"z":"149c03da.6855dc","wires":[["72e676b9.bf2c98"]]},{"id":"41419e5b.e511b","type":"comment","name":"No Success or Failure found","info":"","comments":"","x":264.5,"y":777,"z":"149c03da.6855dc","wires":[]},{"id":"2603ea5d.3a5926","type":"for","name":"for: check status 10 times","xml":"<for index=\"i\" start=\"0\" end=\"10\" >","comments":"","outputs":1,"x":395,"y":160,"z":"149c03da.6855dc","wires":[["4e43662a.ee91c8"]]},{"id":"a3a82482.ab3f28","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":165,"y":162,"z":"149c03da.6855dc","wires":[["2603ea5d.3a5926"]]},{"id":"765b71e8.9bbd8","type":"switchNode","name":"switch: Max retries done?","xml":"<switch test=\"`$i`\">\n","comments":"","outputs":1,"x":979,"y":905,"z":"149c03da.6855dc","wires":[["8f38ae81.92268","472f2e84.4a902"]]},{"id":"8f38ae81.92268","type":"other","name":"outcome: 9","xml":"<outcome value='9'>\n","comments":"","outputs":1,"x":1231,"y":893,"z":"149c03da.6855dc","wires":[["a37d5533.1da868"]]},{"id":"a37d5533.1da868","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1417,"y":887,"z":"149c03da.6855dc","wires":[["b0e805d3.642a98"]]},{"id":"72e676b9.bf2c98","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":772,"y":911,"z":"149c03da.6855dc","wires":[["765b71e8.9bbd8"]]},{"id":"b5b9181.2439fe8","type":"comment","name":"Return Failure so that it exits immediately","info":"Error Code and message reflect the status\nReturning success doesnt exit the loop","comments":"","x":884.5,"y":229,"z":"149c03da.6855dc","wires":[]},{"id":"b0e805d3.642a98","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n<parameter name=\"error-message\" value=\"Configuration Failed. No configuration success or error file found on the device\" />\n<parameter name=\"error-code\" value=\"401\" />\n\n","comments":"","x":1608,"y":884,"z":"149c03da.6855dc","wires":[]},{"id":"be1359f3.76fed8","type":"record","name":"record","xml":"<record plugin=\"org.openecomp.sdnc.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"RETRY ATTEMPT START\" value=\"`$i`\"/>\n","comments":"","outputs":1,"x":343,"y":227,"z":"149c03da.6855dc","wires":[[]]},{"id":"472f2e84.4a902","type":"other","name":"outcome: Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1229,"y":971,"z":"149c03da.6855dc","wires":[["f68d7d4.f244e8"]]},{"id":"f68d7d4.f244e8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1412,"y":969,"z":"149c03da.6855dc","wires":[["8aa4ad89.38ccd"]]},{"id":"8aa4ad89.38ccd","type":"record","name":"record","xml":"<record plugin=\"org.openecomp.sdnc.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"RETRYATTEMPT DONE\"/>\n<parameter name=\"field3\" value=\"`$i`\"/>\n\n\n\n","comments":"","outputs":1,"x":1589,"y":965,"z":"149c03da.6855dc","wires":[[]]},{"id":"608cebd8.10b624","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":521,"y":367,"z":"149c03da.6855dc","wires":[["e9e7c95d.e9fa38"]]},{"id":"e9e7c95d.e9fa38","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":689,"y":371,"z":"149c03da.6855dc","wires":[["8006e9e7.14c678"]]},{"id":"8006e9e7.14c678","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n<parameter name=\"error-message\" value=\"Unable to call SftpAdaptor\" />\n<parameter name=\"error-code\" value=\"401\" />\n ","comments":"","x":868,"y":377,"z":"149c03da.6855dc","wires":[]},{"id":"49953086.03f73","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":618,"y":734,"z":"149c03da.6855dc","wires":[["b1054c2b.0bbe"]]},{"id":"b1054c2b.0bbe","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":818,"y":730,"z":"149c03da.6855dc","wires":[["46d2d7c9.7eb048"]]},{"id":"46d2d7c9.7eb048","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n<parameter name=\"error-message\" value=\"Configuration request Failed. Unable to get Failure Log\" />\n<parameter name=\"error-code\" value=\"401\" />","comments":"","x":1045,"y":731,"z":"149c03da.6855dc","wires":[]},{"id":"86972c32.24588","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1332,"y":607,"z":"149c03da.6855dc","wires":[["b1054c2b.0bbe"]]},{"id":"533f25ea.9ce72c","type":"comment","name":"Set Success Code","info":"","comments":"","x":1055,"y":280,"z":"149c03da.6855dc","wires":[]},{"id":"bccec7e0.e85648","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":671,"y":276,"z":"149c03da.6855dc","wires":[["d3cadd1d.064f3"]]},{"id":"d3cadd1d.064f3","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n<parameter name=\"error-message\" value=\"SUCCESS - request has been processed successfully\" />\n<parameter name=\"error-code\" value=\"400\" />\n","comments":"","x":870,"y":278,"z":"149c03da.6855dc","wires":[]},{"id":"7fb331c5.b68e","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1523,"y":533,"z":"149c03da.6855dc","wires":[["1f59c702.997229"]]},{"id":"1f59c702.997229","type":"execute","name":"execute ParseErrorLog","xml":"<execute plugin=\"org.openecomp.sdnc.config.generator.pattern.PatternNode\" method=\"parseErrorLog\">\n<parameter name=\"logData\" value=\"`$fileContents`\" />\n<parameter name=\"responsePrefix\" value=\"tmp.patternNode\" />","comments":"","outputs":1,"x":1771,"y":530,"z":"149c03da.6855dc","wires":[["b7287d41.8c10e","216d890f.351086","8c0158c.48e0ca8"]]},{"id":"b7287d41.8c10e","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2007,"y":506,"z":"149c03da.6855dc","wires":[["102db338.b4eddd"]]},{"id":"216d890f.351086","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":2012,"y":567,"z":"149c03da.6855dc","wires":[["3185417d.f7dd5e"]]},{"id":"102db338.b4eddd","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2168,"y":507,"z":"149c03da.6855dc","wires":[["f9637605.9c3138"]]},{"id":"3185417d.f7dd5e","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2164,"y":570,"z":"149c03da.6855dc","wires":[["b1314121.4c725"]]},{"id":"b1314121.4c725","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"error-code\" value=\"401\"/>\n\t<parameter name=\"error-message\" value=\"Configuration has failed.Unable to process error log\"/>\n\t","comments":"","x":2346,"y":571,"z":"149c03da.6855dc","wires":[]},{"id":"f9637605.9c3138","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n<parameter name=\"error-code\" value=\"401\"/>\n\t<parameter name=\"error-message\" value=\"`$tmp.patternNode.error-message`\"/>\n\t\n\t","comments":"","x":2366,"y":508,"z":"149c03da.6855dc","wires":[]},{"id":"8c0158c.48e0ca8","type":"not-found","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1991,"y":635,"z":"149c03da.6855dc","wires":[["d19e527d.d65cd"]]},{"id":"d19e527d.d65cd","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2147,"y":637,"z":"149c03da.6855dc","wires":[["985669a3.270458"]]},{"id":"985669a3.270458","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"error-code\" value=\"401\"/>\n\t<parameter name=\"error-message\" value=\"`'Configuration has failed.' + $tmp.patternNode.parsedError`\"/>\n\t","comments":"","x":2319,"y":635,"z":"149c03da.6855dc","wires":[]}]
